import { ethers } from "ethers";
import { ZuploContext, ZuploRequest, environment } from "@zuplo/runtime";

const { WALLET_PRIVATE_KEY, QUICKNODE_API_KEY, INFURA_API_KEY } = environment;
const RPCurl1 = 'https://attentive-convincing-pallet.matic-testnet.quiknode.pro/' + QUICKNODE_API_KEY + '/';
const RPCurl = 'https://sepolia.infura.io/v3/' + INFURA_API_KEY;
const addresses = {
  "1": "0x810664F26F408B698831f5fcdA540a8Bd475Cc0c",
  "56": "0xc0ff4C73FfDc597d9aB7EF95a855001715483363",
  "43114": "0x17DBEfC6F36E47BA8d478122B953e8A50bFB4908",
  "1101": "0x17DBEfC6F36E47BA8d478122B953e8A50bFB4908",
  "11155111": "0xa7F10549D73Da73E17DbCe3aa4587b6Bb968C900"
}

const provider = new ethers.JsonRpcProvider(RPCurl);
const wallet = new ethers.Wallet(WALLET_PRIVATE_KEY as string, provider);

const beaconProxyABI = [{"inputs":[{"internalType":"address","name":"beacon","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"previousAdmin","type":"address"},{"indexed":false,"internalType":"address","name":"newAdmin","type":"address"}],"name":"AdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"beacon","type":"address"}],"name":"BeaconUpgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"implementation","type":"address"}],"name":"Upgraded","type":"event"},{"stateMutability":"payable","type":"fallback"},{"stateMutability":"payable","type":"receive"}]
const beaconProxyBytecode = "0x6080604052604051610af2380380610af283398181016040528101906100259190610615565b61003682825f61003d60201b60201c565b50506108ea565b61004c8361012360201b60201c565b8273ffffffffffffffffffffffffffffffffffffffff167f1cf3b03a6cf19fa2baba4df148e9dcabedea7f8a5c07840e207e5c089be95d3e60405160405180910390a25f8251118061009b5750805b1561011e5761011c8373ffffffffffffffffffffffffffffffffffffffff16635c60da1b6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100ec573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610110919061066f565b8361029f60201b60201c565b505b505050565b610132816102d260201b60201c565b610171576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101689061071a565b60405180910390fd5b6101ec8173ffffffffffffffffffffffffffffffffffffffff16635c60da1b6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156101bd573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101e1919061066f565b6102d260201b60201c565b61022b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610222906107a8565b60405180910390fd5b8061025d7fa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d505f1b6102f460201b60201c565b5f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60606102ca8383604051806060016040528060278152602001610acb602791396102fd60201b60201c565b905092915050565b5f808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b5f819050919050565b60605f808573ffffffffffffffffffffffffffffffffffffffff1685604051610326919061080a565b5f60405180830381855af49150503d805f811461035e576040519150601f19603f3d011682016040523d82523d5f602084013e610363565b606091505b509150915061037a8683838761038560201b60201c565b925050509392505050565b606083156103ec575f8351036103e4576103a4856102d260201b60201c565b6103e3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103da9061086a565b60405180910390fd5b5b8290506103fd565b6103fc838361040560201b60201c565b5b949350505050565b5f825111156104175781518083602001fd5b806040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161044b91906108ca565b60405180910390fd5b5f604051905090565b5f80fd5b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61048e82610465565b9050919050565b61049e81610484565b81146104a8575f80fd5b50565b5f815190506104b981610495565b92915050565b5f80fd5b5f80fd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b61050d826104c7565b810181811067ffffffffffffffff8211171561052c5761052b6104d7565b5b80604052505050565b5f61053e610454565b905061054a8282610504565b919050565b5f67ffffffffffffffff821115610569576105686104d7565b5b610572826104c7565b9050602081019050919050565b5f5b8381101561059c578082015181840152602081019050610581565b5f8484015250505050565b5f6105b96105b48461054f565b610535565b9050828152602081018484840111156105d5576105d46104c3565b5b6105e084828561057f565b509392505050565b5f82601f8301126105fc576105fb6104bf565b5b815161060c8482602086016105a7565b91505092915050565b5f806040838503121561062b5761062a61045d565b5b5f610638858286016104ab565b925050602083015167ffffffffffffffff81111561065957610658610461565b5b610665858286016105e8565b9150509250929050565b5f602082840312156106845761068361045d565b5b5f610691848285016104ab565b91505092915050565b5f82825260208201905092915050565b7f455243313936373a206e657720626561636f6e206973206e6f74206120636f6e5f8201527f7472616374000000000000000000000000000000000000000000000000000000602082015250565b5f61070460258361069a565b915061070f826106aa565b604082019050919050565b5f6020820190508181035f830152610731816106f8565b9050919050565b7f455243313936373a20626561636f6e20696d706c656d656e746174696f6e20695f8201527f73206e6f74206120636f6e747261637400000000000000000000000000000000602082015250565b5f61079260308361069a565b915061079d82610738565b604082019050919050565b5f6020820190508181035f8301526107bf81610786565b9050919050565b5f81519050919050565b5f81905092915050565b5f6107e4826107c6565b6107ee81856107d0565b93506107fe81856020860161057f565b80840191505092915050565b5f61081582846107da565b915081905092915050565b7f416464726573733a2063616c6c20746f206e6f6e2d636f6e74726163740000005f82015250565b5f610854601d8361069a565b915061085f82610820565b602082019050919050565b5f6020820190508181035f83015261088181610848565b9050919050565b5f81519050919050565b5f61089c82610888565b6108a6818561069a565b93506108b681856020860161057f565b6108bf816104c7565b840191505092915050565b5f6020820190508181035f8301526108e28184610892565b905092915050565b6101d4806108f75f395ff3fe608060405261000c61000e565b005b61001e610019610020565b61009a565b565b5f6100296100b9565b73ffffffffffffffffffffffffffffffffffffffff16635c60da1b6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610071573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100959190610173565b905090565b365f80375f80365f845af43d5f803e805f81146100b5573d5ff35b3d5ffd5b5f6100e57fa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d505f1b61010c565b5f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f819050919050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61014282610119565b9050919050565b61015281610138565b811461015c575f80fd5b50565b5f8151905061016d81610149565b92915050565b5f6020828403121561018857610187610115565b5b5f6101958482850161015f565b9150509291505056fea26469706673582212201f74dad793674bfdc9dca519456442d810c94de60f60c39da3f1ef035dbb5a0764736f6c63430008160033416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564"

const multisigABI = [{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"Confirmation","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Deposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"ERC1155Deposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"ERC20Deposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ERC721Deposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"Execution","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"ExecutionFailure","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"Revocation","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"currentSigner","type":"address"},{"indexed":true,"internalType":"address","name":"newSigner","type":"address"}],"name":"SignerChangeRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"oldSigner","type":"address"},{"indexed":true,"internalType":"address","name":"newSigner","type":"address"}],"name":"SignerUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"Submission","type":"event"},{"inputs":[],"name":"MAX_OWNER_COUNT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_oldSigner","type":"address"},{"internalType":"address","name":"_newSigner","type":"address"}],"name":"confirmSignerChange","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"confirmTransaction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"confirmations","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"depositERC1155","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"depositERC20","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"depositERC721","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"getConfirmationCount","outputs":[{"internalType":"uint256","name":"count","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"getConfirmations","outputs":[{"internalType":"address[]","name":"_confirmations","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bool","name":"pending","type":"bool"},{"internalType":"bool","name":"executed","type":"bool"}],"name":"getTransactionCount","outputs":[{"internalType":"uint256","name":"count","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"from","type":"uint256"},{"internalType":"uint256","name":"to","type":"uint256"},{"internalType":"bool","name":"pending","type":"bool"},{"internalType":"bool","name":"executed","type":"bool"}],"name":"getTransactionIds","outputs":[{"internalType":"uint256[]","name":"_transactionIds","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"_signers","type":"address[]"},{"internalType":"uint256","name":"_required","type":"uint256"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"transactionId","type":"uint256"}],"name":"isConfirmed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isSigner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256[]","name":"","type":"uint256[]"},{"internalType":"uint256[]","name":"","type":"uint256[]"},{"internalType":"bytes","name":"","type":"bytes"}],"name":"onERC1155BatchReceived","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes","name":"","type":"bytes"}],"name":"onERC1155Received","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes","name":"","type":"bytes"}],"name":"onERC721Received","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_oldSigner","type":"address"},{"internalType":"address","name":"_newSigner","type":"address"}],"name":"requestSignerChange","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"required","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"}],"name":"signerChangeConfirmations","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"signerChangeRequests","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"signers","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"addresspayable","name":"destination","type":"address"},{"internalType":"address","name":"token","type":"address"},{"internalType":"enumMultiSigWallet.TokenStandard","name":"ts","type":"uint8"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"uint256","name":"confirmTimestamp","type":"uint256"}],"name":"submitTransaction","outputs":[{"internalType":"uint256","name":"transactionId","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"transactionCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"transactions","outputs":[{"internalType":"bool","name":"executed","type":"bool"},{"internalType":"addresspayable","name":"destination","type":"address"},{"internalType":"address","name":"token","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enumMultiSigWallet.TokenStandard","name":"ts","type":"uint8"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"uint256","name":"confirmTimestamp","type":"uint256"},{"internalType":"uint256","name":"txTimestamp","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]
const multisigBytecode = "0x608060405234801561000f575f80fd5b50615ab2806200001e5f395ff3fe6080604052600436106101c5575f3560e01c806397feb926116100f6578063b77bf60011610094578063d74f8edd11610063578063d74f8edd1461074c578063dc8452cd14610776578063f23a6e61146107a0578063f2fde38b146107dc5761023a565b8063b77bf60014610696578063bc197c81146106c0578063c01a8c84146106fc578063d29a4bf6146107245761023a565b80639e3c1b61116100d05780639e3c1b61146105ba578063a0602f06146105e2578063a8abe69a1461061e578063b5dc40c31461065a5761023a565b806397feb92614610526578063998f24af1461054e5780639ace38c2146105765761023a565b806360b5bb3f116101635780637df73e271161013d5780637df73e271461044857806382f25bf7146104845780638b51d13f146104c05780638da5cb5b146104fc5761023a565b806360b5bb3f146103ce578063715018a6146103f6578063784547a71461040c5761023a565b806330f9503c1161019f57806330f9503c146102f25780633411c81c1461031a578063539022601461035657806354741525146103925761023a565b806301ffc9a71461023e578063150b7a021461027a5780632079fb9a146102b65761023a565b3661023a575f341115610238575f73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f5548c837ab068cf56a2c2479df0882a4922fd203edb7517321831d95078c5f623460405161022f91906139c9565b60405180910390a35b005b5f80fd5b348015610249575f80fd5b50610264600480360381019061025f9190613a48565b610804565b6040516102719190613a8d565b60405180910390f35b348015610285575f80fd5b506102a0600480360381019061029b9190613c66565b61087d565b6040516102ad9190613cf5565b60405180910390f35b3480156102c1575f80fd5b506102dc60048036038101906102d79190613d0e565b610890565b6040516102e99190613d48565b60405180910390f35b3480156102fd575f80fd5b5061031860048036038101906103139190613d61565b6108cb565b005b348015610325575f80fd5b50610340600480360381019061033b9190613d9f565b610c29565b60405161034d9190613a8d565b60405180910390f35b348015610361575f80fd5b5061037c60048036038101906103779190613e3b565b610c53565b60405161038991906139c9565b60405180910390f35b34801561039d575f80fd5b506103b860048036038101906103b39190613f1e565b610d11565b6040516103c591906139c9565b60405180910390f35b3480156103d9575f80fd5b506103f460048036038101906103ef9190614020565b610db6565b005b348015610401575f80fd5b5061040a61114d565b005b348015610417575f80fd5b50610432600480360381019061042d9190613d0e565b611160565b60405161043f9190613a8d565b60405180910390f35b348015610453575f80fd5b5061046e6004803603810190610469919061407a565b611255565b60405161047b9190613a8d565b60405180910390f35b34801561048f575f80fd5b506104aa60048036038101906104a5919061407a565b611272565b6040516104b79190613d48565b60405180910390f35b3480156104cb575f80fd5b506104e660048036038101906104e19190613d0e565b6112a2565b6040516104f391906139c9565b60405180910390f35b348015610507575f80fd5b50610510611378565b60405161051d9190613d48565b60405180910390f35b348015610531575f80fd5b5061054c600480360381019061054791906140a5565b6113a0565b005b348015610559575f80fd5b50610574600480360381019061056f9190613d61565b6114e6565b005b348015610581575f80fd5b5061059c60048036038101906105979190613d0e565b611aac565b6040516105b1999897969594939291906141df565b60405180910390f35b3480156105c5575f80fd5b506105e060048036038101906105db9190614271565b611bd2565b005b3480156105ed575f80fd5b5061060860048036038101906106039190613d61565b611caa565b6040516106159190613a8d565b60405180910390f35b348015610629575f80fd5b50610644600480360381019061063f91906142c1565b611cd4565b60405161065191906143dc565b60405180910390f35b348015610665575f80fd5b50610680600480360381019061067b9190613d0e565b611eef565b60405161068d91906144b3565b60405180910390f35b3480156106a1575f80fd5b506106aa61216a565b6040516106b791906139c9565b60405180910390f35b3480156106cb575f80fd5b506106e660048036038101906106e19190614593565b612170565b6040516106f39190613cf5565b60405180910390f35b348015610707575f80fd5b50610722600480360381019061071d9190613d0e565b612184565b005b34801561072f575f80fd5b5061074a600480360381019061074591906140a5565b61244c565b005b348015610757575f80fd5b5061076061251f565b60405161076d91906139c9565b60405180910390f35b348015610781575f80fd5b5061078a612524565b60405161079791906139c9565b60405180910390f35b3480156107ab575f80fd5b506107c660048036038101906107c1919061465e565b61252a565b6040516107d39190613cf5565b60405180910390f35b3480156107e7575f80fd5b5061080260048036038101906107fd919061407a565b61253e565b005b5f7f4e2312e0000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614806108765750610875826125dc565b5b9050919050565b5f63150b7a0260e01b9050949350505050565b60ce818154811061089f575f80fd5b905f5260205f20015f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6108d3612645565b60cd5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1661095c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109539061474b565b60405180910390fd5b60cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16156109e6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109dd906147b3565b60405180910390fd5b6109ee611378565b73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610a5b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a529061481b565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff1660cb5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610b5057610b4f60cb5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff166126c3565b5b8060cb5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff167f458bce772f34fc534e68a2ecbfbe97fa730845fa322a79b3b4a1481f4c8be1e160405160405180910390a35050565b60ca602052815f5260405f20602052805f5260405f205f915091509054906101000a900460ff1681565b5f3360cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16610cde576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610cd590614883565b60405180910390fd5b5f610ce76127b7565b9050610cf98a8a8a8a8a8a8a886127be565b9250610d0483612184565b5050979650505050505050565b5f805f90505b60d054811015610daf57838015610d4b575060c95f8281526020019081526020015f205f015f9054906101000a900460ff16155b8015610d5d5750610d5b81612a31565b155b80610d8d5750828015610d8c575060c95f8281526020019081526020015f205f015f9054906101000a900460ff165b5b15610da257600182610d9f91906148ce565b91505b8080600101915050610d17565b5092915050565b5f8060019054906101000a900460ff16159050808015610de5575060015f8054906101000a900460ff1660ff16105b80610e115750610df430612a8a565b158015610e10575060015f8054906101000a900460ff1660ff16145b5b610e50576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e4790614971565b60405180910390fd5b60015f806101000a81548160ff021916908360ff1602179055508015610e8b5760015f60016101000a81548160ff0219169083151502179055505b825182600a8211158015610ea157508160cf5411155b8015610ead57505f8114155b8015610eb957505f8214155b610ef8576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610eef906149d9565b60405180910390fd5b610f00612aac565b5f5b85518110156110cf5760cd5f878381518110610f2157610f206149f7565b5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16158015610fc257505f73ffffffffffffffffffffffffffffffffffffffff16868281518110610fa157610fa06149f7565b5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1614155b801561101457503373ffffffffffffffffffffffffffffffffffffffff16868281518110610ff357610ff26149f7565b5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1614155b611053576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161104a90614a6e565b60405180910390fd5b600160cd5f88848151811061106b5761106a6149f7565b5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff0219169083151502179055508080600101915050610f02565b508460ce90805190602001906110e692919061390f565b508360cf8190555050508015611148575f8060016101000a81548160ff0219169083151502179055507f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb3847402498600160405161113f9190614ada565b60405180910390a15b505050565b611155612645565b61115e5f612b04565b565b5f805f90505f60ca5f8581526020019081526020015f2090505f60ce8054905090505f5b8181101561124857825f60ce83815481106111a2576111a16149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16156112255760018461122291906148ce565b93505b60cf54840361123b576001945050505050611250565b8080600101915050611184565b505f93505050505b919050565b60cd602052805f5260405f205f915054906101000a900460ff1681565b60cb602052805f5260405f205f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f8060ca5f8481526020019081526020015f2090505f60ce8054905090505f5b8181101561137057825f60ce83815481106112e0576112df6149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16156113635760018461136091906148ce565b93505b80806001019150506112c2565b505050919050565b5f60335f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361140e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161140590614b3d565b60405180910390fd5b5f8111611450576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161144790614ba5565b60405180910390fd5b61147d3330838573ffffffffffffffffffffffffffffffffffffffff16612bc7909392919063ffffffff16565b8173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fe33e9822e3317b004d587136bab2627ea1ecfbba4eb79abddd0a56cfdd09c0e1836040516114da91906139c9565b60405180910390a35050565b3360cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16611570576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161156790614883565b60405180910390fd5b60cc5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615611635576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161162c90614c0d565b60405180910390fd5b8173ffffffffffffffffffffffffffffffffffffffff1660cb5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146116ff576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016116f690614c75565b60405180910390fd5b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361176d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161176490614d03565b60405180910390fd5b611775611378565b73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036117e2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016117d99061481b565b60405180910390fd5b60cd5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff161561186c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611863906147b3565b60405180910390fd5b600160cc5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555061190582612c50565b15611aa757611913826126c3565b5f60cb5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555061199783612d67565b600160cd5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555060ce82908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f2d025324f0a785e8c12d0a0d91a9caa49df4ef20ff87e0df7213a1d4f3157beb60405160405180910390a35b505050565b60c9602052805f5260405f205f91509050805f015f9054906101000a900460ff1690805f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806002018054611b2790614d4e565b80601f0160208091040260200160405190810160405280929190818152602001828054611b5390614d4e565b8015611b9e5780601f10611b7557610100808354040283529160200191611b9e565b820191905f5260205f20905b815481529060010190602001808311611b8157829003601f168201915b505050505090806003015f9054906101000a900460ff16908060040154908060050154908060060154908060070154905089565b8273ffffffffffffffffffffffffffffffffffffffff1663f242432a333085856040518563ffffffff1660e01b8152600401611c119493929190614da1565b5f604051808303815f87803b158015611c28575f80fd5b505af1158015611c3a573d5f803e3d5ffd5b505050508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f81ca208a9e3cb5a41cc28eb453c2f9b8433e6306fb145713f0b2c3e707f604568484604051611c9d929190614df7565b60405180910390a3505050565b60cc602052815f5260405f20602052805f5260405f205f915091509054906101000a900460ff1681565b6060838510611d18576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611d0f90614e8e565b60405180910390fd5b611d248560d054612f9c565b9450611d328460d054612fb4565b93505f8585611d419190614eac565b67ffffffffffffffff811115611d5a57611d59613b42565b5b604051908082528060200260200182016040528015611d885781602001602082028036833780820191505090505b5090505f808790505b86811015611e4757858015611dc3575060c95f8281526020019081526020015f205f015f9054906101000a900460ff16155b8015611dd55750611dd381612a31565b155b80611e055750848015611e04575060c95f8281526020019081526020015f205f015f9054906101000a900460ff165b5b15611e3a5780838381518110611e1e57611e1d6149f7565b5b602002602001018181525050600182611e3791906148ce565b91505b8080600101915050611d91565b508067ffffffffffffffff811115611e6257611e61613b42565b5b604051908082528060200260200182016040528015611e905781602001602082028036833780820191505090505b5092505f5b81811015611ee457828181518110611eb057611eaf6149f7565b5b6020026020010151848281518110611ecb57611eca6149f7565b5b6020026020010181815250508080600101915050611e95565b505050949350505050565b60605f60ce8054905090505f8167ffffffffffffffff811115611f1557611f14613b42565b5b604051908082528060200260200182016040528015611f435781602001602082028036833780820191505090505b5090505f60ca5f8681526020019081526020015f2090505f805b8481101561209457825f60ce8381548110611f7b57611f7a6149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16156120875760ce8181548110612002576120016149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1684838151811061203d5761203c6149f7565b5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505060018261208491906148ce565b91505b8080600101915050611f5d565b8167ffffffffffffffff8111156120ae576120ad613b42565b5b6040519080825280602002602001820160405280156120dc5781602001602082028036833780820191505090505b5095505f90505b81811015612160578381815181106120fe576120fd6149f7565b5b6020026020010151868281518110612119576121186149f7565b5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505080806001019150506120e3565b5050505050919050565b60d05481565b5f63bc197c8160e01b905095945050505050565b3360cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1661220e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161220590614883565b60405180910390fd5b815f73ffffffffffffffffffffffffffffffffffffffff1660c95f8381526020019081526020015f205f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16036122b0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016122a790614f29565b60405180910390fd5b823360ca5f8381526020019081526020015f205f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff161561234b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161234290614f91565b60405180910390fd5b61235485612a31565b15612394576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161238b90614ff9565b60405180910390fd5b600160ca5f8781526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550843373ffffffffffffffffffffffffffffffffffffffff167f4a504a94899432a9846e1aa406dceb1bcfd538bb839071d49d1e5e23f5be30ef60405160405180910390a361244585612fcc565b5050505050565b8173ffffffffffffffffffffffffffffffffffffffff166342842e0e3330846040518463ffffffff1660e01b815260040161248993929190615017565b5f604051808303815f87803b1580156124a0575f80fd5b505af11580156124b2573d5f803e3d5ffd5b505050508173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f20d9d42fbcdd65fce5c3986b701b04ffb8e09852d04a93422dd4be124ae10a8e8360405161251391906139c9565b60405180910390a35050565b600a81565b60cf5481565b5f63f23a6e6160e01b905095945050505050565b612546612645565b60cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16156125d0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016125c7906150bc565b60405180910390fd5b6125d981613537565b50565b5f7f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b61264d6135b9565b73ffffffffffffffffffffffffffffffffffffffff1661266b611378565b73ffffffffffffffffffffffffffffffffffffffff16146126c1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016126b890615124565b60405180910390fd5b565b5f60ce8054905090505f60cc5f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2090505f5b828110156127b1575f825f60ce848154811061272d5761272c6149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550808060010191505061270e565b50505050565b5f42905090565b5f885f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361282e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016128259061518c565b60405180910390fd5b60d05491506040518061012001604052805f151581526020018b73ffffffffffffffffffffffffffffffffffffffff1681526020018a73ffffffffffffffffffffffffffffffffffffffff1681526020018681526020018960038111156128985761289761416c565b5b81526020018881526020018781526020018581526020018481525060c95f8481526020019081526020015f205f820151815f015f6101000a81548160ff0219169083151502179055506020820151815f0160016101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506040820151816001015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506060820151816002019081612982919061533e565b506080820151816003015f6101000a81548160ff021916908360038111156129ad576129ac61416c565b5b021790555060a0820151816004015560c0820151816005015560e082015181600601556101008201518160070155905050600160d05f8282546129f091906148ce565b92505081905550817fc0ba8fe4b176c1714197d43b9cc6bcf797a4a7461c5fe8d0ef6e184ae7601e5160405160405180910390a25098975050505050505050565b5f8060c95f8481526020019081526020015f20905080600601548160070154612a5a91906148ce565b612a626127b7565b1080612a7157505f8160060154145b15612a7f575f915050612a85565b60019150505b919050565b5f808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b5f60019054906101000a900460ff16612afa576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612af19061547d565b60405180910390fd5b612b026135c0565b565b5f60335f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160335f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b612c4a846323b872dd60e01b858585604051602401612be893929190615017565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff8381831617835250505050613620565b50505050565b5f8060ce8054905090505f8060cc5f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2090505f5b8381108015612cad575060cf5483105b15612d5757815f60ce8381548110612cc857612cc76149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615612d4a578280612d469061549b565b9350505b8080600101915050612c9d565b5060cf5482149350505050919050565b60cd5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615612f99575f60ce8054905090505f5b81811015612f96578273ffffffffffffffffffffffffffffffffffffffff1660ce8281548110612df457612df36149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1603612f8957600182612e449190614eac565b8114612eec5760ce600183612e599190614eac565b81548110612e6a57612e696149f7565b5b905f5260205f20015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660ce8281548110612ea657612ea56149f7565b5b905f5260205f20015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b60ce805480612efe57612efd6154e2565b5b600190038181905f5260205f20015f6101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905590555f60cd5f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550612f96565b8080600101915050612dc1565b50505b50565b5f818310612faa5781612fac565b825b905092915050565b5f818311612fc25781612fc4565b825b905092915050565b8060c95f8281526020019081526020015f205f015f9054906101000a900460ff161561302d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161302490615559565b60405180910390fd5b61303682611160565b15613533575f60c95f8481526020019081526020015f2090506001815f015f6101000a81548160ff02191690831515021790555060038081111561307d5761307c61416c565b5b816003015f9054906101000a900460ff1660038111156130a05761309f61416c565b5b036132065780600501544710156130ec576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016130e3906155c1565b60405180910390fd5b5f815f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1682600501548360020160405161313d9190615669565b5f6040518083038185875af1925050503d805f8114613177576040519150601f19603f3d011682016040523d82523d5f602084013e61317c565b606091505b5050905080156131b857837f33e13ecb54c3076d8e8bb8c2881800a4d972b792045ffae98fdf46df365fed7560405160405180910390a2613200565b837f526441bb6c1aba3c9a4a6ca1d6545da9c2333c8c48343ef398eb858d72b7923660405160405180910390a25f825f015f6101000a81548160ff0219169083151502179055505b50613531565b5f60038111156132195761321861416c565b5b816003015f9054906101000a900460ff16600381111561323c5761323b61416c565b5b036132e8576132b6815f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff168260050154836001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166136e69092919063ffffffff16565b827f33e13ecb54c3076d8e8bb8c2881800a4d972b792045ffae98fdf46df365fed7560405160405180910390a2613530565b600160038111156132fc576132fb61416c565b5b816003015f9054906101000a900460ff16600381111561331f5761331e61416c565b5b0361340a57806001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166342842e0e30835f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff1684600401546040518463ffffffff1660e01b81526004016133ab939291906156d1565b5f604051808303815f87803b1580156133c2575f80fd5b505af11580156133d4573d5f803e3d5ffd5b50505050827f33e13ecb54c3076d8e8bb8c2881800a4d972b792045ffae98fdf46df365fed7560405160405180910390a261352f565b6002600381111561341e5761341d61416c565b5b816003015f9054906101000a900460ff1660038111156134415761344061416c565b5b0361352e57806001015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663f242432a30835f0160019054906101000a900473ffffffffffffffffffffffffffffffffffffffff16846004015485600501546040518563ffffffff1660e01b81526004016134d39493929190615706565b5f604051808303815f87803b1580156134ea575f80fd5b505af11580156134fc573d5f803e3d5ffd5b50505050827f33e13ecb54c3076d8e8bb8c2881800a4d972b792045ffae98fdf46df365fed7560405160405180910390a25b5b5b5b505b5050565b61353f612645565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036135ad576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016135a4906157cc565b60405180910390fd5b6135b681612b04565b50565b5f33905090565b5f60019054906101000a900460ff1661360e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016136059061547d565b60405180910390fd5b61361e6136196135b9565b612b04565b565b5f613681826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c65648152508573ffffffffffffffffffffffffffffffffffffffff1661376c9092919063ffffffff16565b90505f815114806136a25750808060200190518101906136a191906157fe565b5b6136e1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016136d890615899565b60405180910390fd5b505050565b6137678363a9059cbb60e01b84846040516024016137059291906158b7565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff8381831617835250505050613620565b505050565b606061377a84845f85613783565b90509392505050565b6060824710156137c8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016137bf9061594e565b60405180910390fd5b5f808673ffffffffffffffffffffffffffffffffffffffff1685876040516137f0919061599c565b5f6040518083038185875af1925050503d805f811461382a576040519150601f19603f3d011682016040523d82523d5f602084013e61382f565b606091505b50915091506138408783838761384c565b92505050949350505050565b606083156138ad575f8351036138a55761386585612a8a565b6138a4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161389b906159fc565b60405180910390fd5b5b8290506138b8565b6138b783836138c0565b5b949350505050565b5f825111156138d25781518083602001fd5b806040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016139069190615a5c565b60405180910390fd5b828054828255905f5260205f20908101928215613985579160200282015b82811115613984578251825f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055509160200191906001019061392d565b5b5090506139929190613996565b5090565b5b808211156139ad575f815f905550600101613997565b5090565b5f819050919050565b6139c3816139b1565b82525050565b5f6020820190506139dc5f8301846139ba565b92915050565b5f604051905090565b5f80fd5b5f80fd5b5f7fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b613a27816139f3565b8114613a31575f80fd5b50565b5f81359050613a4281613a1e565b92915050565b5f60208284031215613a5d57613a5c6139eb565b5b5f613a6a84828501613a34565b91505092915050565b5f8115159050919050565b613a8781613a73565b82525050565b5f602082019050613aa05f830184613a7e565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f613acf82613aa6565b9050919050565b613adf81613ac5565b8114613ae9575f80fd5b50565b5f81359050613afa81613ad6565b92915050565b613b09816139b1565b8114613b13575f80fd5b50565b5f81359050613b2481613b00565b92915050565b5f80fd5b5f80fd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b613b7882613b32565b810181811067ffffffffffffffff82111715613b9757613b96613b42565b5b80604052505050565b5f613ba96139e2565b9050613bb58282613b6f565b919050565b5f67ffffffffffffffff821115613bd457613bd3613b42565b5b613bdd82613b32565b9050602081019050919050565b828183375f83830152505050565b5f613c0a613c0584613bba565b613ba0565b905082815260208101848484011115613c2657613c25613b2e565b5b613c31848285613bea565b509392505050565b5f82601f830112613c4d57613c4c613b2a565b5b8135613c5d848260208601613bf8565b91505092915050565b5f805f8060808587031215613c7e57613c7d6139eb565b5b5f613c8b87828801613aec565b9450506020613c9c87828801613aec565b9350506040613cad87828801613b16565b925050606085013567ffffffffffffffff811115613cce57613ccd6139ef565b5b613cda87828801613c39565b91505092959194509250565b613cef816139f3565b82525050565b5f602082019050613d085f830184613ce6565b92915050565b5f60208284031215613d2357613d226139eb565b5b5f613d3084828501613b16565b91505092915050565b613d4281613ac5565b82525050565b5f602082019050613d5b5f830184613d39565b92915050565b5f8060408385031215613d7757613d766139eb565b5b5f613d8485828601613aec565b9250506020613d9585828601613aec565b9150509250929050565b5f8060408385031215613db557613db46139eb565b5b5f613dc285828601613b16565b9250506020613dd385828601613aec565b9150509250929050565b5f613de782613aa6565b9050919050565b613df781613ddd565b8114613e01575f80fd5b50565b5f81359050613e1281613dee565b92915050565b60048110613e24575f80fd5b50565b5f81359050613e3581613e18565b92915050565b5f805f805f805f60e0888a031215613e5657613e556139eb565b5b5f613e638a828b01613e04565b9750506020613e748a828b01613aec565b9650506040613e858a828b01613e27565b9550506060613e968a828b01613b16565b9450506080613ea78a828b01613b16565b93505060a088013567ffffffffffffffff811115613ec857613ec76139ef565b5b613ed48a828b01613c39565b92505060c0613ee58a828b01613b16565b91505092959891949750929550565b613efd81613a73565b8114613f07575f80fd5b50565b5f81359050613f1881613ef4565b92915050565b5f8060408385031215613f3457613f336139eb565b5b5f613f4185828601613f0a565b9250506020613f5285828601613f0a565b9150509250929050565b5f67ffffffffffffffff821115613f7657613f75613b42565b5b602082029050602081019050919050565b5f80fd5b5f613f9d613f9884613f5c565b613ba0565b90508083825260208201905060208402830185811115613fc057613fbf613f87565b5b835b81811015613fe95780613fd58882613aec565b845260208401935050602081019050613fc2565b5050509392505050565b5f82601f83011261400757614006613b2a565b5b8135614017848260208601613f8b565b91505092915050565b5f8060408385031215614036576140356139eb565b5b5f83013567ffffffffffffffff811115614053576140526139ef565b5b61405f85828601613ff3565b925050602061407085828601613b16565b9150509250929050565b5f6020828403121561408f5761408e6139eb565b5b5f61409c84828501613aec565b91505092915050565b5f80604083850312156140bb576140ba6139eb565b5b5f6140c885828601613aec565b92505060206140d985828601613b16565b9150509250929050565b6140ec81613ddd565b82525050565b5f81519050919050565b5f82825260208201905092915050565b5f5b8381101561412957808201518184015260208101905061410e565b5f8484015250505050565b5f61413e826140f2565b61414881856140fc565b935061415881856020860161410c565b61416181613b32565b840191505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602160045260245ffd5b600481106141aa576141a961416c565b5b50565b5f8190506141ba82614199565b919050565b5f6141c9826141ad565b9050919050565b6141d9816141bf565b82525050565b5f610120820190506141f35f83018c613a7e565b614200602083018b6140e3565b61420d604083018a613d39565b818103606083015261421f8189614134565b905061422e60808301886141d0565b61423b60a08301876139ba565b61424860c08301866139ba565b61425560e08301856139ba565b6142636101008301846139ba565b9a9950505050505050505050565b5f805f60608486031215614288576142876139eb565b5b5f61429586828701613aec565b93505060206142a686828701613b16565b92505060406142b786828701613b16565b9150509250925092565b5f805f80608085870312156142d9576142d86139eb565b5b5f6142e687828801613b16565b94505060206142f787828801613b16565b935050604061430887828801613f0a565b925050606061431987828801613f0a565b91505092959194509250565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b614357816139b1565b82525050565b5f614368838361434e565b60208301905092915050565b5f602082019050919050565b5f61438a82614325565b614394818561432f565b935061439f8361433f565b805f5b838110156143cf5781516143b6888261435d565b97506143c183614374565b9250506001810190506143a2565b5085935050505092915050565b5f6020820190508181035f8301526143f48184614380565b905092915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b61442e81613ac5565b82525050565b5f61443f8383614425565b60208301905092915050565b5f602082019050919050565b5f614461826143fc565b61446b8185614406565b935061447683614416565b805f5b838110156144a657815161448d8882614434565b97506144988361444b565b925050600181019050614479565b5085935050505092915050565b5f6020820190508181035f8301526144cb8184614457565b905092915050565b5f67ffffffffffffffff8211156144ed576144ec613b42565b5b602082029050602081019050919050565b5f61451061450b846144d3565b613ba0565b9050808382526020820190506020840283018581111561453357614532613f87565b5b835b8181101561455c57806145488882613b16565b845260208401935050602081019050614535565b5050509392505050565b5f82601f83011261457a57614579613b2a565b5b813561458a8482602086016144fe565b91505092915050565b5f805f805f60a086880312156145ac576145ab6139eb565b5b5f6145b988828901613aec565b95505060206145ca88828901613aec565b945050604086013567ffffffffffffffff8111156145eb576145ea6139ef565b5b6145f788828901614566565b935050606086013567ffffffffffffffff811115614618576146176139ef565b5b61462488828901614566565b925050608086013567ffffffffffffffff811115614645576146446139ef565b5b61465188828901613c39565b9150509295509295909350565b5f805f805f60a08688031215614677576146766139eb565b5b5f61468488828901613aec565b955050602061469588828901613aec565b94505060406146a688828901613b16565b93505060606146b788828901613b16565b925050608086013567ffffffffffffffff8111156146d8576146d76139ef565b5b6146e488828901613c39565b9150509295509295909350565b5f82825260208201905092915050565b7f4f6c64207369676e657220646f6573206e6f742065786973742e0000000000005f82015250565b5f614735601a836146f1565b915061474082614701565b602082019050919050565b5f6020820190508181035f83015261476281614729565b9050919050565b7f4e6577207369676e657220697320616c72656164792061207369676e65722e005f82015250565b5f61479d601f836146f1565b91506147a882614769565b602082019050919050565b5f6020820190508181035f8301526147ca81614791565b9050919050565b7f4f6e7765722063616e6e6f742062652061207369676e65722e000000000000005f82015250565b5f6148056019836146f1565b9150614810826147d1565b602082019050919050565b5f6020820190508181035f830152614832816147f9565b9050919050565b7f5369676e657220646f6573206e6f7420657869737400000000000000000000005f82015250565b5f61486d6015836146f1565b915061487882614839565b602082019050919050565b5f6020820190508181035f83015261489a81614861565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6148d8826139b1565b91506148e3836139b1565b92508282019050808211156148fb576148fa6148a1565b5b92915050565b7f496e697469616c697a61626c653a20636f6e747261637420697320616c7265615f8201527f647920696e697469616c697a6564000000000000000000000000000000000000602082015250565b5f61495b602e836146f1565b915061496682614901565b604082019050919050565b5f6020820190508181035f8301526149888161494f565b9050919050565b7f496e76616c696420726571756972656d656e74000000000000000000000000005f82015250565b5f6149c36013836146f1565b91506149ce8261498f565b602082019050919050565b5f6020820190508181035f8301526149f0816149b7565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b7f496e76616c6964207369676e65720000000000000000000000000000000000005f82015250565b5f614a58600e836146f1565b9150614a6382614a24565b602082019050919050565b5f6020820190508181035f830152614a8581614a4c565b9050919050565b5f819050919050565b5f60ff82169050919050565b5f819050919050565b5f614ac4614abf614aba84614a8c565b614aa1565b614a95565b9050919050565b614ad481614aaa565b82525050565b5f602082019050614aed5f830184614acb565b92915050565b7f696e76616c696420746f6b656e000000000000000000000000000000000000005f82015250565b5f614b27600d836146f1565b9150614b3282614af3565b602082019050919050565b5f6020820190508181035f830152614b5481614b1b565b9050919050565b7f696e76616c696420616d6f756e740000000000000000000000000000000000005f82015250565b5f614b8f600e836146f1565b9150614b9a82614b5b565b602082019050919050565b5f6020820190508181035f830152614bbc81614b83565b9050919050565b7f596f7520616c726561647920636f6e6669726d65642e000000000000000000005f82015250565b5f614bf76016836146f1565b9150614c0282614bc3565b602082019050919050565b5f6020820190508181035f830152614c2481614beb565b9050919050565b7f4e6577207369676e6572206164647265737320696e76616c69642e00000000005f82015250565b5f614c5f601b836146f1565b9150614c6a82614c2b565b602082019050919050565b5f6020820190508181035f830152614c8c81614c53565b9050919050565b7f4e6f2070656e64696e67207369676e65722075706461746520726571756573745f8201527f2e00000000000000000000000000000000000000000000000000000000000000602082015250565b5f614ced6021836146f1565b9150614cf882614c93565b604082019050919050565b5f6020820190508181035f830152614d1a81614ce1565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f6002820490506001821680614d6557607f821691505b602082108103614d7857614d77614d21565b5b50919050565b50565b5f614d8c5f836140fc565b9150614d9782614d7e565b5f82019050919050565b5f60a082019050614db45f830187613d39565b614dc16020830186613d39565b614dce60408301856139ba565b614ddb60608301846139ba565b8181036080830152614dec81614d81565b905095945050505050565b5f604082019050614e0a5f8301856139ba565b614e1760208301846139ba565b9392505050565b7f496e76616c69642072616e67653a2066726f6d206d757374206265206c6573735f8201527f207468616e20746f000000000000000000000000000000000000000000000000602082015250565b5f614e786028836146f1565b9150614e8382614e1e565b604082019050919050565b5f6020820190508181035f830152614ea581614e6c565b9050919050565b5f614eb6826139b1565b9150614ec1836139b1565b9250828203905081811115614ed957614ed86148a1565b5b92915050565b7f5472616e73616374696f6e20646f6573206e6f742065786973740000000000005f82015250565b5f614f13601a836146f1565b9150614f1e82614edf565b602082019050919050565b5f6020820190508181035f830152614f4081614f07565b9050919050565b7f5472616e73616374696f6e20616c726561647920636f6e6669726d65640000005f82015250565b5f614f7b601d836146f1565b9150614f8682614f47565b602082019050919050565b5f6020820190508181035f830152614fa881614f6f565b9050919050565b7f5472616e73616374696f6e2074696d6564206f75742e000000000000000000005f82015250565b5f614fe36016836146f1565b9150614fee82614faf565b602082019050919050565b5f6020820190508181035f83015261501081614fd7565b9050919050565b5f60608201905061502a5f830186613d39565b6150376020830185613d39565b61504460408301846139ba565b949350505050565b7f4f776e61626c653a206e6577206f776e65722063616e6e6f74206265207369675f8201527f6e65722e00000000000000000000000000000000000000000000000000000000602082015250565b5f6150a66024836146f1565b91506150b18261504c565b604082019050919050565b5f6020820190508181035f8301526150d38161509a565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65725f82015250565b5f61510e6020836146f1565b9150615119826150da565b602082019050919050565b5f6020820190508181035f83015261513b81615102565b9050919050565b7f416464726573732063616e6e6f74206265206e756c6c000000000000000000005f82015250565b5f6151766016836146f1565b915061518182615142565b602082019050919050565b5f6020820190508181035f8301526151a38161516a565b9050919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026152067fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826151cb565b61521086836151cb565b95508019841693508086168417925050509392505050565b5f61524261523d615238846139b1565b614aa1565b6139b1565b9050919050565b5f819050919050565b61525b83615228565b61526f61526782615249565b8484546151d7565b825550505050565b5f90565b615283615277565b61528e818484615252565b505050565b5b818110156152b1576152a65f8261527b565b600181019050615294565b5050565b601f8211156152f6576152c7816151aa565b6152d0846151bc565b810160208510156152df578190505b6152f36152eb856151bc565b830182615293565b50505b505050565b5f82821c905092915050565b5f6153165f19846008026152fb565b1980831691505092915050565b5f61532e8383615307565b9150826002028217905092915050565b615347826140f2565b67ffffffffffffffff8111156153605761535f613b42565b5b61536a8254614d4e565b6153758282856152b5565b5f60209050601f8311600181146153a6575f8415615394578287015190505b61539e8582615323565b865550615405565b601f1984166153b4866151aa565b5f5b828110156153db578489015182556001820191506020850194506020810190506153b6565b868310156153f857848901516153f4601f891682615307565b8355505b6001600288020188555050505b505050505050565b7f496e697469616c697a61626c653a20636f6e7472616374206973206e6f7420695f8201527f6e697469616c697a696e67000000000000000000000000000000000000000000602082015250565b5f615467602b836146f1565b91506154728261540d565b604082019050919050565b5f6020820190508181035f8301526154948161545b565b9050919050565b5f6154a5826139b1565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82036154d7576154d66148a1565b5b600182019050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603160045260245ffd5b7f5472616e73616374696f6e20616c7265616479206578656375746564000000005f82015250565b5f615543601c836146f1565b915061554e8261550f565b602082019050919050565b5f6020820190508181035f83015261557081615537565b9050919050565b7f6e6f7420656e6f75676820616d6f756e7420746f2077697468647261770000005f82015250565b5f6155ab601d836146f1565b91506155b682615577565b602082019050919050565b5f6020820190508181035f8301526155d88161559f565b9050919050565b5f81905092915050565b5f81546155f581614d4e565b6155ff81866155df565b9450600182165f8114615619576001811461562e57615660565b60ff1983168652811515820286019350615660565b615637856151aa565b5f5b8381101561565857815481890152600182019150602081019050615639565b838801955050505b50505092915050565b5f61567482846155e9565b915081905092915050565b5f61569961569461568f84613aa6565b614aa1565b613aa6565b9050919050565b5f6156aa8261567f565b9050919050565b5f6156bb826156a0565b9050919050565b6156cb816156b1565b82525050565b5f6060820190506156e45f830186613d39565b6156f160208301856156c2565b6156fe60408301846139ba565b949350505050565b5f60a0820190506157195f830187613d39565b61572660208301866156c2565b61573360408301856139ba565b61574060608301846139ba565b818103608083015261575181614d81565b905095945050505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f20615f8201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b5f6157b66026836146f1565b91506157c18261575c565b604082019050919050565b5f6020820190508181035f8301526157e3816157aa565b9050919050565b5f815190506157f881613ef4565b92915050565b5f60208284031215615813576158126139eb565b5b5f615820848285016157ea565b91505092915050565b7f5361666545524332303a204552433230206f7065726174696f6e20646964206e5f8201527f6f74207375636365656400000000000000000000000000000000000000000000602082015250565b5f615883602a836146f1565b915061588e82615829565b604082019050919050565b5f6020820190508181035f8301526158b081615877565b9050919050565b5f6040820190506158ca5f830185613d39565b6158d760208301846139ba565b9392505050565b7f416464726573733a20696e73756666696369656e742062616c616e636520666f5f8201527f722063616c6c0000000000000000000000000000000000000000000000000000602082015250565b5f6159386026836146f1565b9150615943826158de565b604082019050919050565b5f6020820190508181035f8301526159658161592c565b9050919050565b5f615976826140f2565b61598081856155df565b935061599081856020860161410c565b80840191505092915050565b5f6159a7828461596c565b915081905092915050565b7f416464726573733a2063616c6c20746f206e6f6e2d636f6e74726163740000005f82015250565b5f6159e6601d836146f1565b91506159f1826159b2565b602082019050919050565b5f6020820190508181035f830152615a13816159da565b9050919050565b5f81519050919050565b5f615a2e82615a1a565b615a3881856146f1565b9350615a4881856020860161410c565b615a5181613b32565b840191505092915050565b5f6020820190508181035f830152615a748184615a24565b90509291505056fea264697066735822122082c450d5e9538e8380eb15c14517bdd6a43d1314d45573e5d993adf16775006e64736f6c63430008160033"

const contractFactory = new ethers.ContractFactory(multisigABI, multisigBytecode, wallet);
const beaconFactory = new ethers.ContractFactory(beaconProxyABI , beaconProxyBytecode, wallet);

export default async function (request: ZuploRequest, context: ZuploContext) {
  console.log("controling the request");
  const req = await request.json()
  const chainId = await req.chainId;
  const bodyreq_signers = await req.signers;
  if (typeof bodyreq_signers != "object") {
    return {
      error: "Invalid argument type of signers",
    };
  }
  if (bodyreq_signers.length < 2 || bodyreq_signers.length > 10) {
    return {
      error: "Invalid number of signers, expected between 2 and 10",
    };
  }

  for (let i = 0; i < bodyreq_signers.length; i++) {
    if (!ethers.isAddress(bodyreq_signers[i])) {
      return {
        error: "Invalid Ethereum address at index " + i + " (current address: \'" + bodyreq_signers[i] + "\')",
      };
    }
  }


  const bodyreq_required = await req.required;
  if (typeof bodyreq_required != "number") {
    return {
      error: "Invalid argument type of required",
    };
  }
  if (bodyreq_required < 1 || bodyreq_required > bodyreq_signers.length) {
    return {
      error: "Invalid number of required, expected between 1 and the number of signers (in your request : " + bodyreq_signers.length + " signers)",
    };
  }

  console.log("preparing the transaction data");

  const nonce = await wallet.getNonce();

  const constructorArgs = [bodyreq_signers, bodyreq_required];
  const multisigArgsData = contractFactory.interface.encodeFunctionData("initialize", constructorArgs);
  const beaconProxyData = beaconFactory.interface.encodeDeploy([addresses[chainId], multisigArgsData]);
  const data = ethers.concat([beaconFactory.bytecode, beaconProxyData]);
  console.log("deploying with transaction data");
  const tx = {
    nonce: nonce,
    to: null,
    value: 0,
    gasPrice: 3060267955,
    gasLimit: 21000000,
    data: data,
    chainId: +chainId,
  };
  const sendTxResponse = await wallet.sendTransaction(tx);
  console.log("deployed");
  const network = await provider.getNetwork();
  console.log("API response sent");
  return {
    success: "Transaction sent successfully",
    sendTxResponse: sendTxResponse.hash,
    network: network,
  };
};